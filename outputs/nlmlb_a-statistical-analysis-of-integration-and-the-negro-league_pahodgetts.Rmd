---
title: "A Statistical Analysis of Integration and the Negro League"
author: "Paul A. Hodgetts"
date: "09/04/2021"
output: 
  pdf_document:
    latex_engine: lualatex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, echo=F, message=F, warning=F}
# uncomment any packages that require installation

# installs tidyverse package for working with data
# version 1.3.1
#install.packages("tidyverse")

# installs here package for accessing directories
# version 1.0.1
#install.packages("here")

# installs showtext package for loading Google fonts
# version 0.9-2
#install.packages("showtext")
```

```{r libraries, echo=F, message=F, warning=F}
# load tidyverse package
# version 1.3.0
library(tidyverse)

# load here package
# version 1.0.1
library(here)

# load showtext package
# version 0.9-2
library(showtext)
```

```{r showtext, message=F, warning=F, echo=F}
# access Jost font from Google fonts
font_add_google(name = "jost", family = "jost-sans-serif")

# load font
showtext_auto()
```

```{r load data, echo=F, message=F, warning=F}
source(here("script/rmarkdown/load_data.R"))
```

```{r prep data, echo=F, warning=F, message=F}
source(here("script/rmarkdown/prep_data.R"))
```

```{r, echo=F, message=F, warning=F, fig.align = "center"}
nl_df %>%
  ggplot()+
  geom_histogram(aes(x = debut, fill = "Debut"), binwidth = 2, 
                 colour = "white")+
  geom_histogram(aes(x = last_game, fill = "Last Game"), binwidth = 2, 
                 colour = "white", alpha = 0.75)+
  theme_minimal()+
  labs(x = "Year",
       y = "Count")+
  theme(text = element_text(family = "jost-sans-serif"),
        panel.grid.minor = element_blank(),
        panel.grid.major.x = element_blank(),
        legend.position = "top")+
  scale_x_continuous(breaks = c(1874, 1884, 1894, 1904, 
                                1914, 1924, 1934, 1944, 
                                1954, 1964, 1975))+
  scale_y_continuous(breaks = c(0, 25, 50, 75, 100, 125, 150, 175))+
  scale_fill_manual(name = "Legend", values = c("#dd3530", "dodgerblue"))+
  geom_vline(xintercept = c(1920, 1947, 1948, 1962), 
             colour = "#010210", linetype = "solid", size = 0.5)+
  annotate("text", x = 1938.25, y = 111, 
           label = "1947: Jackie Robinson debuts\n for the Brooklyn Dodgers",
           colour = "#010210",
           size = 2)+
  annotate("text", x = 1911.25, y = 111, 
           label = "1920: Negro National League\n established",
           colour = "#010210",
           size = 2)+
  annotate("text", x = 1969, y = 111, 
            label = "1962: Negro American\n League folds",
            colour = "#010210",
           size = 2)+
  annotate("text", x = 1954.5, y = 111, 
           label = "1948: Negro National\n League folds",
           colour = "#010210",
           size = 2)
```

```{r}
x <- nl_mlb_df %>% 
  group_by(mlb_debut) %>% 
  mutate(blah = sum(played_negro_league))


```


```{r, echo=F, message=F, warning=F, fig.align = "center"}
nl_mlb_df %>%
  filter(played_negro_league == 1) %>% 
  ggplot(aes(x = year, y = debut_count))+
  geom_point(colour = "dodgerblue", size = 3)+
  geom_line(colour = "dodgerblue")+
  theme_minimal()+
  theme(text = element_text(family = "jost-sans-serif"))+
  labs(y = "Player Count",
       x = "Year")+
  scale_x_continuous(breaks = c(1947, 1950, 1953, 1956, 1959, 
                                1962, 1965, 1968, 1971, 1974,
                                1977))+
  scale_y_continuous(breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11))
```

